<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html>
<head>
    <title>ACAPI_LibPart_GetSectionList</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="Author" content="@@@_author_@@@">

    <meta http-equiv="Content-Language" content="en-US">
    <link rel="stylesheet" type="text/css" href="../../StyleLibrary/Style.css">
    <script type="text/javascript" src="../../StyleLibrary/Java.js"></script>
    <script type="text/javascript" src="../../StyleLibrary/TOCscript.js"></script>
    <script type="text/javascript">
      LEVELSTR = "../../";
      ICONPATH = LEVELSTR + "StyleLibrary/Images/Treeview/";
    </script>
    <script type="text/javascript" src="../../StyleLibrary/TOC.js"></script>
    <script type="text/javascript" src="../../StyleLibrary/tree_tpl.js"></script>
    <script type="text/javascript" src="../../StyleLibrary/tree.js"></script>
    <meta name="Microsoft.Help.F1" content="APIHTMLLibrary/Functions/ACAPI_LibPart_GetSectionList.html">
    <xml>
      <MSHelp:Attr Name = "DocSet" Value = "Graphisoft"/>
    </xml>
</head>
<body>
<div id="docBegin">
  <p id="graphisoft_title">&nbsp;<span>Graphisoft&reg;</span></p>
  <p class="hdr"><span class="TitleMain">API&nbsp;Development&nbsp;Kit</span><span class="TitleVersion">Version: 26</span></p>
</div>
<div id="content" class="inset">
          <script type="text/javascript">
            insertTOC ();
          </script>


    <h1>ACAPI_LibPart_GetSectionList</h1>

    <p>Returns the list of sections contained by a registered Library Part.</p>
    <pre class="syntax">
    <strong>GSErrCode  ACAPI_LibPart_GetSectionList</strong> (
        <strong>Int32</strong>                     <em>libInd</em>,
        <strong>Int32*</strong>                    <em>nSection</em>,
        <strong><a href="../Structures/API_LibPartSection.html">API_LibPartSection</a>***</strong>     <em>sections</em>
    );
</pre>

    <p>&nbsp;</p>

    <h4>Parameters</h4>

    <dl>
        <dt><em>libInd</em></dt>

        <dd>[in] Index of the library part</dd>

        <dt><em>nSection</em></dt>

        <dd>[out] Number of the sections found</dd>

        <dt><em>sections</em></dt>

        <dd>[out] section data returned</dd>
    </dl>

    <p>&nbsp;</p>

    <h4>Return Values</h4>

    <dl>
        <dt><code>NoError</code></dt>

        <dd>The function has completed with success.</dd>

        <dt><code>APIERR_BADPARS</code></dt>

        <dd>Invalid <code>libInd,</code> or<br>
        any of the parameters are <code>nullptr</code>, or<br>
        the addressed Library Part is a macro, picture file etc.</dd>
    </dl>

    <p>For other common API errors see the <a href="../Level2/Error_Codes.html">API Errors</a>.</p>

    <p>&nbsp;</p>

    <h4>Remarks</h4>

    <p>This function is used to get the headers of the sections the library part is built from.</p>

    <p>The function works only on real Library Parts. In the case the type of the target Library Part is not listed below, the function returns an error code. This is since other type of Library Parts are just simple picture or text files which are enumerated and registered from the active library folders; such a picture or macro.</p>

    <p>Applicable type of Library Parts are:</p>

    <ul class="syntax">
        <li><a href="../Structures/API_LibTypeID.html">APILib_WindowID</a>,</li>

        <li><a href="../Structures/API_LibTypeID.html">APILib_DoorID</a>,</li>

        <li><a href="../Structures/API_LibTypeID.html">APILib_ObjectID</a>,</li>

        <li><a href="../Structures/API_LibTypeID.html">APILib_LampID</a>,</li>

        <li><a href="../Structures/API_LibTypeID.html">APILib_RoomID</a>,</li>

        <li><a href="../Structures/API_LibTypeID.html">APILib_LabelID</a>,</li>

        <li><a href="../Structures/API_LibTypeID.html">APILib_MacroObjID</a>,</li>

        <li><a href="../Structures/API_LibTypeID.html">APILib_PropertyID</a></li>
    </ul>

    <p>Do not forget to dispose the returned handle if it is not needed any more.</p>

    <p>Note, that it cannot be used between <a href="ACAPI_LibPart_Create.html">ACAPI_LibPart_Create</a> and <a href="ACAPI_LibPart_Save.html">ACAPI_LibPart_Save</a> functions.</p>

    <p>&nbsp;</p>

    <h4>Example</h4>

    <blockquote>
        <pre><code>
Int32                nSection = 0;
API_LibPartSection   **sectList;
GSHandle             sectionHdl;
char                 buffer[128];

GSErrCode err = ACAPI_LibPart_GetSectionList (1, &amp;nSection, &amp;sectList);
if (err == NoError) {
    for (Int32 i = 0; i &lt; nSection; i++) {
        API_LibPartSection* sectionPtr = *sectList + i;
        err = ACAPI_LibPart_GetSection (1, sectionPtr, &amp;sectionHdl, nullptr);
        BMKillHandle (&amp;sectionHdl);
        sprintf (buffer, "sectType: %d, subIndent: %d, version: %d", sectionPtr-&gt;sectType, sectionPtr-&gt;subIdent, sectionPtr-&gt;version);
        ACAPI_WriteReport (buffer, false);
    }
    BMKillHandle ((GSHandle *) &amp;sectList);
}
</code></pre>
    </blockquote>

    <p>&nbsp;</p>

    <h4>Requirements</h4>

    <dl>
        <dd><b>Version:</b> API 2.1 or later</dd>

        <dd><b>Header:</b> ACAPinc.h</dd>
    </dl>

    <p>&nbsp;</p>

    <h4>See Also</h4>

    <p><a href="../Structures/API_LibPartSection.html">API_LibPartSection</a>,<br>
    <a href="ACAPI_LibPart_GetSection.html">ACAPI_LibPart_GetSection</a>, <a href="ACAPI_LibPart_Create.html">ACAPI_LibPart_Create</a>, <a href="ACAPI_LibPart_Save.html">ACAPI_LibPart_Save</a>,<br>
    <a href="../Level3/Library_Part_Manager_id.html">LibPart Manager</a>, <a href="API_Functions.html">API Functions</a></p>

    

</div>
<div id="footer">
    <p class="hdr1">      <span class="Credits">Copyright &copy; 2022 - GRAPHISOFT SE. All rights reserved worldwide. <br />Modified on December 17, 2007<br/>
      </span>
    </p>
    <p id="toplink"><a href="#docBegin"><img src="../../StyleLibrary/Images/top.gif" alt="top" width="31" height="14" id="toTopImg" /></a></p>
</div>
</body>
</html>
