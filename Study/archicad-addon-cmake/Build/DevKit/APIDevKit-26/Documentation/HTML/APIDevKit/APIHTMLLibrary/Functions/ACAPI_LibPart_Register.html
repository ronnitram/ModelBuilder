<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
ï»¿<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html>
<head>
    <title>ACAPI_LibPart_Register</title>
    <meta name="GENERATOR" content="Microsoft FrontPage 4.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="Author" content="@@@_author_@@@">

    <meta http-equiv="Content-Language" content="en-US">
    <link rel="stylesheet" type="text/css" href="../../StyleLibrary/Style.css">
    <script type="text/javascript" src="../../StyleLibrary/Java.js"></script>
    <script type="text/javascript" src="../../StyleLibrary/TOCscript.js"></script>
    <script type="text/javascript">
      LEVELSTR = "../../";
      ICONPATH = LEVELSTR + "StyleLibrary/Images/Treeview/";
    </script>
    <script type="text/javascript" src="../../StyleLibrary/TOC.js"></script>
    <script type="text/javascript" src="../../StyleLibrary/tree_tpl.js"></script>
    <script type="text/javascript" src="../../StyleLibrary/tree.js"></script>
    <meta name="Microsoft.Help.F1" content="APIHTMLLibrary/Functions/ACAPI_LibPart_Register.html">
    <xml>
      <MSHelp:Attr Name = "DocSet" Value = "Graphisoft"/>
    </xml>
</head>
<body>
<div id="docBegin">
  <p id="graphisoft_title">&nbsp;<span>Graphisoft&reg;</span></p>
  <p class="hdr"><span class="TitleMain">API&nbsp;Development&nbsp;Kit</span><span class="TitleVersion">Version: 26</span></p>
</div>
<div id="content" class="inset">
          <script type="text/javascript">
            insertTOC ();
          </script>


    <h1>ACAPI_LibPart_Register</h1>

    <p>Registers a Library Part.</p>
    <pre class="syntax">
    <strong>GSErrCode  ACAPI_LibPart_Register</strong> (
        <strong><a href="../Structures/API_LibPart.html">API_LibPart</a>*</strong>     <em>libPart</em>
    );
</pre>

    <p>&nbsp;</p>

    <h4>Parameters</h4>

    <dl>
        <dt><em>libPart</em></dt>

        <dd>[in/out] Parameters of the library part;<br>
        the type, the owner signature and the file descriptor of the library part, must be initialized, by setting the typeID, ownerID and the fileDef fields respectively. Other values will be filled and returned by Archicad.</dd>
    </dl>

    <p>&nbsp;</p>

    <h4>Return Values</h4>

    <dl>
        <dt><code>NoError</code></dt>

        <dd>The function has completed with success.</dd>

        <dt><code>APIERR_BADPARS</code></dt>

        <dd><code>libPart</code> is <code>nullptr</code>, or refers to invalid data</dd>
    </dl>

    <p>For other common API errors see the <a href="../Level2/Error_Codes.html">API Errors.</a></p>

    <p>&nbsp;</p>

    <h4>Remarks</h4>

    <p>This function is used to register a new Library Part.</p>

    <p>You can register any kind of Library Part, however this function basically implemented for handling macros and pictures. These type of Library Parts are simple text and picture files which can be created without any help of the API. If you want to create a new macro, you just have to create a simple text file somewhere in the file system, and register it as a macro.</p>

    <p>If the function has completed with success, the reference index is returned by Archicad in the <code>libPart-&gt;index</code> parameter. Use this value to reference to the registered Library Part in any subsequent operation.</p>

    <p>Creating real Archicad library parts are much more complicated. Although the file format is public, it is strongly recommended to use the API functions while creating an object, lamp, door etc. kind library part. In this case you do not have to register it, because the <a href="ACAPI_LibPart_Save.html">ACAPI_LibPart_Save</a> function does it.</p>

    <p>This function is a non-undoable data structure modifier function. See more details on this topic at <a href="../Level2/Command_Overview.html">Command Overview</a>.</p>

    <p>&nbsp;</p>

    <h4>Example</h4>

    <blockquote>
        <pre><code>
IO::Location     fileLoc ("C:\\temp\\MyLibpart.gsm");
API_LibPart      libPart;
GSErrCode        err;

BNZeroMemory (&amp;libPart, sizeof (API_LibPart));
libPart.typeID   = APILib_ObjectID;
libPart.location = &amp;fileLoc;
err = ACAPI_LibPart_Register (&amp;libPart);
</code></pre>
    </blockquote>

    <h4>Requirements</h4>

    <dl>
        <dd><b>Version:</b> API 4.1 or later</dd>

        <dd><b>Header:</b> ACAPinc.h</dd>
    </dl>

    <p>&nbsp;</p>

    <h4>See Also</h4>

    <p><a href="../Structures/API_LibPart.html">API_LibPart</a>,<br>
    <a href="ACAPI_LibPart_Save.html">ACAPI_LibPart_Save</a>,<br>
    <a href="ACAPI_LibPart_RegisterAll.html">ACAPI_LibPart_RegisterAll</a>,<br>
    <a href="../Level3/Library_Part_Manager_id.html">LibPart Manager</a>, <a href="API_Functions.html">API Functions</a></p>

    

</div>
<div id="footer">
    <p class="hdr1">      <span class="Credits">Copyright &copy; 2022 - GRAPHISOFT SE. All rights reserved worldwide. <br />Modified on November 6, 2014<br/>
      </span>
    </p>
    <p id="toplink"><a href="#docBegin"><img src="../../StyleLibrary/Images/top.gif" alt="top" width="31" height="14" id="toTopImg" /></a></p>
</div>
</body>
</html>
