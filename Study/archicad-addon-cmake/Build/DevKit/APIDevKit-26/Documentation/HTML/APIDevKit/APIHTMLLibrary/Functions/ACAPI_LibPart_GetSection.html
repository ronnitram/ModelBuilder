<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html>
<head>
    <title>ACAPI_LibPart_GetSection</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="Author" content="@@@_author_@@@">

    <meta http-equiv="Content-Language" content="en-US">
    <link rel="stylesheet" type="text/css" href="../../StyleLibrary/Style.css">
    <script type="text/javascript" src="../../StyleLibrary/Java.js"></script>
    <script type="text/javascript" src="../../StyleLibrary/TOCscript.js"></script>
    <script type="text/javascript">
      LEVELSTR = "../../";
      ICONPATH = LEVELSTR + "StyleLibrary/Images/Treeview/";
    </script>
    <script type="text/javascript" src="../../StyleLibrary/TOC.js"></script>
    <script type="text/javascript" src="../../StyleLibrary/tree_tpl.js"></script>
    <script type="text/javascript" src="../../StyleLibrary/tree.js"></script>
    <meta name="Microsoft.Help.F1" content="APIHTMLLibrary/Functions/ACAPI_LibPart_GetSection.html">
    <xml>
      <MSHelp:Attr Name = "DocSet" Value = "Graphisoft"/>
    </xml>
</head>
<body>
<div id="docBegin">
  <p id="graphisoft_title">&nbsp;<span>Graphisoft&reg;</span></p>
  <p class="hdr"><span class="TitleMain">API&nbsp;Development&nbsp;Kit</span><span class="TitleVersion">Version: 26</span></p>
</div>
<div id="content" class="inset">
          <script type="text/javascript">
            insertTOC ();
          </script>


    <h1>ACAPI_LibPart_GetSection</h1>

    <p>Returns an existing section of a registered Library Part.</p>
    <pre class="syntax">
    <strong>GSErrCode  ACAPI_LibPart_GetSection</strong> (
        <strong>Int32</strong>                   <em>libInd</em>,
        <strong><a href="../Structures/API_LibPartSection.html">API_LibPartSection</a>*</strong>     <em>section</em>,
        <strong>GSHandle*</strong>               <em>sectionHdl</em>,
        <strong><a href="../../../GSRoot/GSRootHTMLLibrary/GS/UniString/UniString.html">GS::UniString</a>*</strong>          <em>sectionStr</em>,
        <strong><a href="../../../GSRoot/GSRootHTMLLibrary/GS/UniString/UniString.html">GS::UniString</a>*</strong>          <em>password = nullptr</em>
    );
</pre>

    <p>&nbsp;</p>

    <h4>Parameters</h4>

    <dl>
        <dt><em>libInd</em></dt>

        <dd>[in] Index of the library part</dd>

        <dt><em>section</em></dt>

        <dd>[in/out] Definition of the section. The section is defined by the <code>sectType</code> an the <code>subIdent</code> fields of the <a href="../Structures/API_LibPartSection.html">API_LibPartSection</a> structure.</dd>

        <dt><em>sectionHdl</em></dt>

        <dd>[out] Section data.</dd>

        <dt><em>sectionStr</em>&nbsp;<img border="0" src="../../APIImageLibrary/11.png" alt="Featuring API 11" width="19" height="12"></dt>

        <dd>[out] The content of textual sections as a Unicode string. Pass the address of an existing Unicode string if you need this data.</dd>

        <dt><em>password</em>&nbsp;<img border="0" src="../../APIImageLibrary/16.png" alt="Featuring API 16" width="19" height="12"></dt>

        <dd>[in] The (optional) password that encrypted the section.</dd>
    </dl>

    <p>&nbsp;</p>

    <h4>Return Values</h4>

    <dl>
        <dt><code>NoError</code></dt>

        <dd>The function has completed with success.</dd>

        <dt><code>APIERR_BADPARS</code></dt>

        <dd>Invalid <code>libInd,</code> or<br>
        any of the parameters are <code>nullptr</code>, or<br>
        the addressed Library Part is a macro, picture file etc.</dd>

        <dt><code>APIERR_NOLIBSECT</code></dt>

        <dd>no such a section in the Library Part</dd>
    </dl>

    <p>For other common API errors see the <a href="../Level2/Error_Codes.html">API Errors</a>.</p>

    <p>&nbsp;</p>

    <h4>Remarks</h4>

    <p>This function is used to get the data of the requested section from the Library Part.</p>

    <p>It returns the requested section of the Library Part defined by <tt>libInd</tt> in the <tt>sectionHdl</tt>. The section is defined by the <tt>sectType</tt> field of the <a href="../Structures/API_LibPartSection.html">API_LibPartSection</a> structure. If it (a four-character case-sensitive identifier) is not any of the standard types, it is interpreted as a custom type. In this case you are responsible for the content and the management of this section. The description of the standard sections can be found in the Archicad Reference Manual.</p>

    <p>The function works only on real Library Parts. In the case the type of the target Library Part is not listed below, the function returns an error code. This is since other type of Library Parts are just simple picture or text files which are enumerated and registered from the active library folders; such a picture or macro.</p>

    <p>Applicable type of Library Parts are:</p>

    <ul class="syntax">
        <li><a href="../Structures/API_LibTypeID.html">APILib_WindowID</a>,</li>

        <li><a href="../Structures/API_LibTypeID.html">APILib_DoorID</a>,</li>

        <li><a href="../Structures/API_LibTypeID.html">APILib_ObjectID</a>,</li>

        <li><a href="../Structures/API_LibTypeID.html">APILib_LampID</a>,</li>

        <li><a href="../Structures/API_LibTypeID.html">APILib_RoomID</a>,</li>

        <li><a href="../Structures/API_LibTypeID.html">APILib_LabelID</a>,</li>

        <li><a href="../Structures/API_LibTypeID.html">APILib_MacroObjID</a>,</li>

        <li><a href="../Structures/API_LibTypeID.html">APILib_PropertyID</a></li>
    </ul>

    <p>Do not forget to dispose the data if it is not needed any more.</p>

    <p>From API 11, the textual section data is now stored as a <code>GS::UniString</code> in the library parts. You can also obtain the text in this format in the <code>sectionStr</code> parameter.</p>

    <h4>&nbsp;</h4>

    <h4>Example</h4>

    <p>See the example of the <a href="ACAPI_LibPart_GetSectionList.html">ACAPI_LibPart_GetSectionList</a> function. &nbsp;</p>

    <p>&nbsp;</p>

    <h4>Requirements</h4>

    <dl>
        <dd><b>Version:</b> API 1.3 or later</dd>

        <dd><b>Header:</b> ACAPinc.h</dd>
    </dl>

    <p>&nbsp;</p>

    <h4>See Also</h4>

    <p><a href="../Structures/API_LibPartSection.html">API_LibPartSection</a>, <a href="ACAPI_LibPart_GetSectionList.html">ACAPI_LibPart_GetSectionList</a>,<br>
    <a href="../Level3/Library_Part_Manager_id.html">LibPart Manager</a>, <a href="API_Functions.html">API Functions</a></p>

    

</div>
<div id="footer">
    <p class="hdr1">      <span class="Credits">Copyright &copy; 2022 - GRAPHISOFT SE. All rights reserved worldwide. <br />Modified on March 24, 2012<br/>
      </span>
    </p>
    <p id="toplink"><a href="#docBegin"><img src="../../StyleLibrary/Images/top.gif" alt="top" width="31" height="14" id="toTopImg" /></a></p>
</div>
</body>
</html>
