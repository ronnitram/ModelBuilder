<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html>
<head>
    <title>Adding new file types</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="Author" content="Magyari Denes">
    <meta name="ProgId" content="FrontPage.Editor.Document">

    <meta http-equiv="Content-Language" content="en-US">
    <link rel="stylesheet" type="text/css" href="../StyleLibrary/Style.css">
    <script type="text/javascript" src="../StyleLibrary/Java.js"></script>
    <script type="text/javascript" src="../StyleLibrary/TOCscript.js"></script>
    <script type="text/javascript">
      LEVELSTR = "../";
      ICONPATH = LEVELSTR + "StyleLibrary/Images/Treeview/";
    </script>
    <script type="text/javascript" src="../StyleLibrary/TOC.js"></script>
    <script type="text/javascript" src="../StyleLibrary/tree_tpl.js"></script>
    <script type="text/javascript" src="../StyleLibrary/tree.js"></script>
    <meta name="Microsoft.Help.F1" content="HTML_Library/addingtypes.html">
    <xml>
      <MSHelp:Attr Name = "DocSet" Value = "Graphisoft"/>
    </xml>
</head>
<body>
<div id="docBegin">
  <p id="graphisoft_title">&nbsp;<span>Graphisoft&reg;</span></p>
  <p class="hdr"><span class="TitleMain">File&nbsp;Type&nbsp;Manager</span><span class="TitleVersion">Version: 1.0</span></p>
</div>
<div id="content" class="inset">
          <script type="text/javascript">
            insertTOC ();
          </script>


    <h1>Adding new file types to the file type manager</h1>

    <p>The following is a brief example for how to use the file type management classes. The main viewpoint of the description is from the perspective of the developer whose purpose to insert his file type into the file type manager.</p>

    <ul>
        <li>Create a callback function for&nbsp;your file type.
            <pre>
bool BMPTypeCallback(IChannel&amp; ic, long* retVal)
{
        UNUSED_PARAMETER(retVal);
        char buffer[2];
        if (ic.ReadBin (buffer, 2) != NoError)
                return false;
        if (buffer[0] == 'B' &amp;&amp; buffer[1] == 'M')
                return true;

        return false;
}
</pre>
        </li>

        <li>Create a FileTypeManager instance. There is no need to derive your own class from FileTypeManager.
            <pre>
FTM::FileTypeManager moduleTypeManager ("Module");
</pre>
        </li>

        <li>
            <p>Create storage for ids returned by group and type addition functions.</p>
            <pre>
enum{
        bmp,
        etc,
        typeCount
};

FTM::TypeID typeID[typeCount];

enum{
        image,
        vectorImage,
        rasterImage,
        groupCount
};

FTM::GroupID groupID[groupCount];
</pre>
        </li>

        <li>Add groups to database.
            <pre>
groupID[image] = moduleTypeManager.AddGroup ("Images", IO::FileTypeManager::RootGroup);
groupID[rasterImage] = moduleTypeManager.AddGroup ("Raster Images" ,groupID[image]);
groupID[vectorImage] = moduleTypeManager.AddGroup ("Vector Images" ,groupID[image]);
</pre>
        </li>

        <li>Add types into groups.
            <pre>
typeID[bmp] = moduleTypeManager.AddType (IO::FileType("Bitmap files", "bmp", 'GSAC', 'BMP', 145, BMPTypeCallback), groupID[rasterImage]);
</pre>
        </li>

        <li>
            <p>Optionally you can add your file type into groups created by other modules.</p>
            <pre>
moduleTypeManager.AddTypeToGroup (typeID[bmp], someOtherGroup );
</pre>
        </li>
    </ul>

    <h4>See Also</h4>

    <p><a href="FileTypeManager/filetypemanager.html">FileTypeManager</a>, <a href="FileType/filetype.html">FileType</a></p>

    

</div>
<div id="footer">
    <p class="hdr1">      <span class="Credits">Copyright &copy; 2022 - GRAPHISOFT SE. All rights reserved worldwide. <br />Built on July 20, 2000<br/>
      </span>
    </p>
    <p id="toplink"><a href="#docBegin"><img src="../StyleLibrary/Images/top.gif" alt="top" width="31" height="14" id="toTopImg" /></a></p>
</div>
</body>
</html>
